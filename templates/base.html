{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  {% block meta %} {% endblock meta %}
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="{% static 'css/global.css' %}?v={{ now|date:'U' }}">


  <!-- Add DOMPurify here -->
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.5/dist/purify.min.js"></script>
  <script src="{% static 'js/toast.js?v=2' %}"></script>

</head>

<body class="theme-sunset form-style">
  <style>
  </style>
  {% block content %} {% endblock content %}
  {% include 'toast.html' %}
  {% if messages %}
  <script type="application/json" id="dj-messages">
  [
    {% for message in messages %}
      {"text":"{{ message|escapejs }}","level":"{{ message.tags|default_if_none:'info' }}"}{% if not forloop.last %},{% endif %}
    {% endfor %}
  ]
  </script>
<script>
(function () {
  // read & clear a one-shot flash toast from sessionStorage
  try {
    const raw = sessionStorage.getItem('flashToast');
    if (!raw) return;
    sessionStorage.removeItem('flashToast');

    const p = JSON.parse(raw);
    if (typeof window.showToast === 'function') {
      // defaults just in case
      const title = p.title || 'Notice';
      const message = p.message || '';
      const type = p.type || 'normal';
      const duration = Number(p.duration || 3000);
      window.showToast(title, message, type, duration);
    }
  } catch { /* ignore */ }
})();
</script>
  {% endif %}
  {% include 'modal.html' %}
</body>

</html>